<!DOCTYPE html>
<!-- saved from url=(0055)http://twitter.github.com/bootstrap/examples/fluid.html -->
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <title>AppInventor.org</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->

    <link href="../../assets/css/bootstrap.css" rel="stylesheet">
    <link href="../../assets/css/ai_styles.css" rel="stylesheet">
    <style type="text/css">
        body {
            padding-top: 60px;
            padding-bottom: 40px;
        }

        .sidebar-nav {
            padding: 9px 0;
        }
    </style>
    <link href="../../assets/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="http://twitter.github.com/bootstrap/assets/ico/favicon.ico">
    <link rel="apple-touch-icon-precomposed" sizes="144x144"
          href="http://twitter.github.com/bootstrap/assets/ico/apple-touch-icon-144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114"
          href="http://twitter.github.com/bootstrap/assets/ico/apple-touch-icon-114-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72"
          href="http://twitter.github.com/bootstrap/assets/ico/apple-touch-icon-72-precomposed.png">
    <link rel="apple-touch-icon-precomposed"
          href="http://twitter.github.com/bootstrap/assets/ico/apple-touch-icon-57-precomposed.png">
</head>

<body>

<div class="navbar navbar-fixed-top">
    <div class="navbar-inner">
        <div class="container">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>
            <a class="brand" href="/">AppInventor.org</a>

            <div class="nav-collapse">
                <ul class="nav">
                    <!-- <li class="active"><a href="index.html"><i class="icon-home icon-white"></i> Home</a></li> -->
                    <li><a href="#about">About</a></li>
                    <li><a href="#contact">Contact</a></li>
                </ul>


            </div>
            <!--/.nav-collapse -->
        </div>
    </div>
</div>

<div class="container">

    <div class="span8">


        <div class="row-fluid">

            <div class="lead">
                <h1 style="font-size: 42px;">{{ appTitle }}</h1>


            </div>

		 <p><b>Instructions after adding or modifying step</b></p>
		 <ul>
  			<li>Flush the memcached in <a href="https://appengine.google.com/datastore/explorer?submitted=1&app_id=s~appinventororg&show_options=no&version_id=1.366706941235179009&kind=App&query=SELECT+*+FROM+Step" target="_blank">GAE dashboard</a> (at bottom, called "Flush Memcache"), or click <a href="/memcache_flush_all" id="mem_flush_all">Here</a></li>
  			<li>Make sure the step number is not conflicted</li>
  			
		</ul>



        </div>


        <div class="row-fluid">


            <div class="custom-border" style="margin-top: 20px;">

                <div class="row-fluid">


                    <div class="span12">

                        <div id="app_box">


                            <h2>Steps for this app</h2>

                            <div class="thumbnail">

                                <div rows="20" class="input-xxlarge" id="step_listing"></div>

                                <br/>
                                <br/>

                            </div>

                            <br/>


                            <div class="btn-group">


                                <form action="/DeleteStep" method="get">
                                        <a href="#add_step" role="button" class="btn btn-inverse btn"
                                           data-toggle="modal" onclick="clear_step_form();">Add Step</a>
							   <a href="#add_step" role="button" id="mod_step_btn" class="btn btn-success btn"
                                           data-toggle="modal">Mod Step</a>

							   <input class="input" id="del_step_name" type="hidden" name="del_step_name" value=""/>
                                        <input class="btn btn-danger btn-medium" type="submit" value="Delete Step">

                                        {#                <button class="btn">Delete App</button>#}
							  <a href="/Admin" class="btn">Go Back</a>


                                </form>


                            </div>

                        </div>

                    </div>


                </div>

                <div class="row-fluid">
                    &nbsp;
                </div>


                <div class="row-fluid">


                </div>

            </div>


        </div>


        <div class="span6">


        </div>


        {# ADD_APP MODAL #}

        <div id="add_step" class="modal hide fade" tabindex="-1" role="dialog">

            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">Ã—</button>
                <h3 id="myModalLabel">Add or Modify a Step</h3>
            </div>


            <div class="span5">

            <form action="/PostStep" method="post">

                <input class="input" id="modify_step_name" type="hidden" name="modify_step_name" value=""/>




                <div class="form-unit">

                    <input id="mod_name" type="hidden" name="appId" value="{{ appId }}">
                </div>


                <div class="form-unit">
                    <strong>Step Number</strong>

                    <p>

                    </p>
                    <input id="step_number" type="text" name="number">
                </div>


                <div class="form-unit">
                    <strong>Header</strong>

                    <p>
                        <small> A quick summary of the step. Appears in bold at the top of the step.
                        </small>
                    </p>
                    <input id="step_header" type="text" name="header">
                </div>

                <div class="form-unit">
                    <strong>Copy</strong>

                    <p>
                        <small> The instructions for the user.
                        </small>
                    </p>
                    <textarea id="step_copy" name="copy" rows="4" cols="60">Type main step copy here.</textarea>
                </div>

                <div class="form-unit">
                    <strong>Video Path</strong>

                    <p>
                        <small> The video tutorial for this step.
                        </small>
                    </p>
                    <input id="step_video" type="text" name="videoPath">
                </div>

                <div class="form-unit">
                    <strong>Fullscreen Video Path</strong>

                    <p>
                        <small> Getting a direct fullscreen link to the video tutorial requires a hack:
                            you must manually edit the link. Best explained by example: if you have
                            http://www.youtube.com/watch?v=OIkVJ2jq4bA, you must change it to
                            http://www.youtube.com/v/OIkVJ2jq4bA (i.e., replace "watch?v=" with "v/")
                        </small>
                    </p>
                    <input id="step_full" type="text" name="fullscreenPath">
                </div>

                <div class="modal-footer">
                    <input class="btn btn-success btn-medium" type="submit" value="Submit"/>


                </div>


            </form>

                </div>

        </div>

    </div>


</div>
<!-- /container -->

<!-- Le javascript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<script src="../assets/js/jquery.js"></script>
<script src="../assets/js/bootstrap-transition.js"></script>
<script src="../assets/js/bootstrap-alert.js"></script>
<script src="../assets/js/bootstrap-modal.js"></script>
<script src="../assets/js/bootstrap-dropdown.js"></script>
<script src="../assets/js/bootstrap-scrollspy.js"></script>
<script src="../assets/js/bootstrap-tab.js"></script>
<script src="../assets/js/bootstrap-tooltip.js"></script>
<script src="../assets/js/bootstrap-popover.js"></script>
<script src="../assets/js/bootstrap-button.js"></script>
<script src="../assets/js/bootstrap-collapse.js"></script>
<script src="../assets/js/bootstrap-carousel.js"></script>
<script src="../assets/js/bootstrap-typeahead.js"></script>

<script type="text/javascript">  // main scripts

function clear_step_form(){
	$("#app_id").val("");
      $("#step_number").val("");
      $("#step_header").val("");
      $("#step_copy").val("");
      $("#step_video").val("");
	$("#step_full").val("");

	$('.highlight').removeClass('highlight');
	$("#mod_step_btn").attr("disabled", true);//unclickable now
}


$(document).ready(function () {
    $("#mod_step_btn").attr("disabled", true);//init unclickable
    var step_listing = "{{ step_listing }}";
    
    var total_text_elem = '';

    var lines = step_listing.split("|");
    $.each(lines, function (i, item) {
        console.log(item);
        var name = item.slice(3);
        total_text_elem += '<div class="stepname" data-stepname="' + name + '">' + '<a href="#">' + item + '</a>' + '</div>';
    });

    console.log(total_text_elem);

    $("#step_listing").html(total_text_elem);

    $(".stepname").click(function () {
        $('.highlight').removeClass('highlight');
        $(this).addClass('highlight');
	  $("#mod_step_btn").attr("disabled", false);//step seleted, clickalbe now
        var path = $(this).data("stepname");

        console.log("hello, world!");

        {#        get app data#}

        $.getJSON("/get_step_data?step_header=" + path,
                function (data) {

                    console.log("calling get_step_data()");

                    $.each(data, function(i, item) {
                        console.log("item is " + item);

                        if (i == "appId") {
                            $("#app_id").val(item);
                        }

                        if (i == "number") {
                            $("#step_number").val(item);
                        }

                        if (i == "header") {
                            $("#step_header").val(item);
                        }

                        if (i == "copy") {
                            $("#step_copy").val(item);
                        }

                        if (i == "videoPath") {
                            $("#step_video").val(item);
                        }

                        if (i == "fullPath") {
                            $("#step_full").val(item);
                        }
                    });

                });

        console.log("path is " + path);



        //        var original_color = this.style.backgroundColor;
//        this.style.backgroundColor = "#FDFF47";
//        $("appname").effect("highlight", {color:"#669966"}, 3000);
        $("#del_step_name").val(path);
        $("#modify_step_name").val(path);


    });
});


//give memcache_flush_all a redirect link, so it can redirect back to where we were.
document.getElementById("mem_flush_all").setAttribute("href","/memcache_flush_all?redirect_link=" + window.location.href)


</script>

</body>
</html>
